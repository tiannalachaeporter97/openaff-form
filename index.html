<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Anmeldung Kostenlos</title>
  <style>
    * {
      box-sizing: border-box;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }
    body {
      margin: 0;
      padding: 0;
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      background: #f4f6fb;
    }
    .form-shell {
      background: #ffffff;
      border-radius: 18px;
      box-shadow: 0 12px 35px rgba(0,0,0,0.12);
      overflow: hidden;
      border: 1px solid #e0e3f0;
      max-width: 420px;
      width: 100%;
    }
    .form-header {
      background: #0b1030;
      color: #ffffff;
      padding: 22px 26px;
      text-align: center;
      font-weight: 700;
      font-size: 22px;
      letter-spacing: 0.06em;
      text-transform: uppercase;
    }
    .form-body { padding: 28px 30px 30px; }
    .field-group { margin-bottom: 14px; }
    .field-input,
    .phone-input {
      width: 100%;
      padding: 14px 14px;
      border-radius: 6px;
      border: 1px solid #c5cadc;
      font-size: 15px;
      outline: none;
      transition: border-color .18s, box-shadow .18s, background-color .18s;
      background: #fbfcff;
    }
    .field-input::placeholder { color: #9aa1ba; }
    .field-input:focus,
    .phone-input:focus {
      border-color: #192555;
      box-shadow: 0 0 0 1px rgba(25,37,85,0.18);
      background: #ffffff;
    }
    .phone-wrapper {
      display: flex;
      align-items: stretch;
      border-radius: 6px;
      overflow: hidden;
      border: 1px solid #c5cadc;
      background: #fbfcff;
      transition: border-color .18s, box-shadow .18s, background-color .18s;
    }
    .phone-wrapper:focus-within {
      border-color: #192555;
      box-shadow: 0 0 0 1px rgba(25,37,85,0.18);
      background: #ffffff;
    }
    .phone-prefix {
      display: flex;
      align-items: center;
      gap: 6px;
      padding: 0 12px;
      background: #eef0f9;
      border-right: 1px solid #c5cadc;
      font-size: 14px;
      white-space: nowrap;
    }
    .flag { font-size: 18px; }
    .phone-code { font-weight: 500; color: #11152d; }
    .phone-input {
      border: none;
      border-radius: 0;
      background: transparent;
      flex: 1;
    }
    .submit-btn {
      width: 100%;
      margin-top: 12px;
      padding: 14px 16px;
      background: #0b1030;
      color: #ffffff;
      font-weight: 700;
      font-size: 15px;
      letter-spacing: 0.06em;
      text-transform: uppercase;
      border-radius: 8px;
      border: none;
      cursor: pointer;
      box-shadow: 0 7px 14px rgba(8,12,40,0.35);
      transition: transform .1s, box-shadow .1s, opacity .15s;
    }
    .submit-btn:hover {
      transform: translateY(-1px);
      box-shadow: 0 10px 20px rgba(8,12,40,0.4);
    }
    .submit-btn:active {
      transform: translateY(0);
      box-shadow: 0 5px 12px rgba(8,12,40,0.25);
    }
    .submit-btn[disabled] { opacity: .65; cursor: not-allowed; box-shadow: none; }
    .error-box {
      margin-bottom: 10px;
      padding: 10px 12px;
      border-radius: 6px;
      background: #fff3f3;
      border: 1px solid #f1c0c0;
      color: #742020;
      font-size: 13px;
      display: none;
    }
    .error-box ul { margin: 4px 0 0; padding-left: 18px; }
    .note { margin-top: 8px; font-size: 11px; color: #7a81a0; text-align: center; }
    @media (max-width: 480px) {
      .form-shell { margin: 16px; }
      .form-header { font-size: 18px; padding-inline: 18px; }
      .form-body { padding-inline: 18px; }
    }
  </style>
</head>
<body>
  <div class="form-shell">
    <div class="form-header">ANMELDUNG KOSTENLOS</div>
    <div class="form-body">
      <div id="error-box" class="error-box"></div>

      <!-- IMPORTANT: posts to /register (Cloudflare Function) -->
      <form id="lead-form" method="POST" action="/register" autocomplete="on">
        <div class="field-group">
          <input type="text" name="first_name" class="field-input" placeholder="Name" required />
        </div>

        <div class="field-group">
          <input type="text" name="last_name" class="field-input" placeholder="Nachname" required />
        </div>

        <div class="field-group">
          <input type="email" name="email" class="field-input" placeholder="E-Mail" required />
        </div>

        <div class="field-group">
          <div class="phone-wrapper">
            <div class="phone-prefix">
              <span class="flag">ðŸ‡©ðŸ‡ª</span>
              <span class="phone-code">+49</span>
            </div>
            <input type="tel" name="phone" class="phone-input" placeholder="1512 3456789" required />
          </div>
        </div>

        <!-- Hidden fields -->
        <input type="hidden" name="country" value="DE" />
        <input type="hidden" name="phonecc" value="+49" />

        <!-- Optional: clickid from Keitaro / traffic source -->
        <input type="hidden" name="aff_sub" id="aff_sub" />

        <button type="submit" class="submit-btn" id="submit-btn">EINREICHEN</button>
      </form>

      <div class="note">Ihre Daten werden sicher &amp; verschlÃ¼sselt Ã¼bertragen.</div>
    </div>
  </div>

  <script>
    // Put Keitaro/traffic click id into aff_sub if present
    const params = new URLSearchParams(window.location.search);
    const clickId = params.get("click_id") || params.get("clickid") || params.get("subid") || "";
    if (clickId) {
      document.getElementById("aff_sub").value = clickId;
    }

    // Front-end display for errors (coming from /register when we debug)
    const errorBox = document.getElementById("error-box");
    function showErrors(msgs) {
      if (!msgs || !msgs.length) {
        errorBox.style.display = "none";
        errorBox.innerHTML = "";
        return;
      }
      const lis = msgs.map((m) => `<li>${m}</li>`).join("");
      errorBox.innerHTML = `<strong>Bitte Ã¼berprÃ¼fen Sie Ihre Eingaben:</strong><ul>${lis}</ul>`;
      errorBox.style.display = "block";
    }
    // We'll use showErrors later when we need client-side debugging
  </script>
</body>
</html>
